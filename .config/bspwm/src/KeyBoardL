#!/bin/sh

# Get the current layout
CURRENT=$(setxkbmap -query | awk '/layout/ {print $2}')

# Layouts. You can add yours.
LAYOUTS="US English|us
Arabic|ara
Latina|latam
EspaÃ±a|es
France|fr
Deutschland|de
Italia|it
Brasil|br"

# Show rofi menu
show_rofi_menu() {
    printf '%s\n' "$LAYOUTS" | cut -d'|' -f1 | rofi \
        -dmenu \
        -p "Keyboard Layout" \
        -mesg "Current layout --> $CURRENT" \
        -markup-rows \
        -theme "$HOME/.config/rofi/styles/style_01.rasi"
}

# Select and apply the layout
selected=$(show_rofi_menu)
if [ -n "$selected" ]; then
    layout_code=$(printf '%s\n' "$LAYOUTS" | awk -F'|' -v sel="$selected" '$1 == sel {print $2}')
    if [ -n "$layout_code" ]; then
        setxkbmap "$layout_code"
    fi
fi
