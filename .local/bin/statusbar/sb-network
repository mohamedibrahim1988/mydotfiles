#!/usr/bin/sh
info="$(nmcli dev | grep 'wifi')"
wname="$(echo "$info" | awk '$1=$2=$3=""; FNR == 1 {print $0};' | sed 's/^ *//g')"
case $BLOCK_BUTTON in
1) notify-send "$wname" ;;
2) setsid -f "$TERMINAL" -e "$EDITOR" "$0" ;;
3)
    "$TERMINAL" -n network -e nmtui
    pkill -RTMIN+4 dwmblocks
    ;;
esac
# Wifi
if [ "$(cat /sys/class/net/w*/operstate 2>/dev/null)" = 'up' ]; then
    wifiicon="$(awk '/^\s*w/ { print "  ", int($3 * 100 / 70) "%" }' /proc/net/wireless)"
elif [ "$(cat /sys/class/net/w*/operstate 2>/dev/null)" = 'down' ]; then
    [ "$(cat /sys/class/net/w*/flags 2>/dev/null)" = '0x1003' ] && wifiicon=" 󰖪" || wifiicon="窱"
fi
printf "%s\n" "^c#66f9ef^$wifiicon "
