#!/bin/bash

case "$BLOCK_BUTTON" in
1) media-control mute ;;
2) "$TERMINAL" -e "$EDITOR" "$0" ;;
3) pavucontrol ;;
4) media-control up ;;
5) media-control down ;;
esac

function get_volume {
    pactl get-sink-volume @DEFAULT_SINK@ | grep -Po '[0-9]{1,3}(?=%)' | head -1
}

# Uses regex to get mute status from pactl
function get_mute {
    pactl get-sink-mute @DEFAULT_SINK@ | grep -Po '(?<=Mute: )(yes|no)'
}

# Returns a mute icon, a volume-low icon, or a volume-high icon, depending on the volume
volume=$(get_volume)
mute=$(get_mute)
if [ "$volume" -eq 0 ] || [ "$mute" == "yes" ]; then
    volume_icon=""
elif [ "$volume" -lt 50 ]; then
    volume_icon=" "
else
    volume_icon=" "
fi

if [[ "$mute" == "no" ]]; then
    printf "^c#61AFEF^ $volume_icon $volume%% "
else
    printf "^c#61AFEF^  Mute! "
fi
